{% extends "dashboard/partials/base.html" %}

{% block title %}Reservas - {% if current_hotel %}{{ current_hotel.name }}{% endif %}{% endblock %}

{% block content %}


<div class="container-fluid">
    <div class="row">
        <div class="col-lg-12 d-flex align-items-stretch">
            <div class="card w-100 shadow-lg">
                <div class="card-body py-0 px-2">
                    {# <p class="d-inline-flex gap-1">
                        <h4 class="text-center">
                            <a class="" data-bs-toggle="collapse" href="#filtros_quartos" role="button" aria-expanded="false"
                                aria-controls="filtros_quartos">
                                Filtros
                            </a>
                        </h4>
                    </p>
                    <div class="collapse" id="filtros_quartos">
                        <div class="card card-body">
                            <form action="{{ url_for('rooms') }}" method="GET">
                                <div class="row">
                                    <div class="mb-3 col-6">
                                        <label for="criteria" class="form-label">Critério</label>
                                        <select class="form-select" name="criteria" id="criteria">
                                            <option value="">Selecione o critério do filtro</option>
                                            <option value="room_number">Número do quarto</option>
                                            <option value="price">Preço (diária)</option>
                                            <option value="capacity_adults">Capacidade de Adultos</option>
                                            <option value="capacity_children">Capacidade de Crianças</option>
                                            <option value="capacity_total">Capacidade Total</option>
                                        </select>
                                    </div>
                                    <div class="mb-3 col-6">
                                        <label for="order" class="form-label">Ordem</label>
                                        <select class="form-select" name="order" id="order">
                                            <option value="">Selecione a ordem</option>
                                            <option value="cres">Crescente</option>
                                            <option value="decres">Decrescente</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="row mb-4">
                                    <div class="col-6">
                                        <label class="form-label">Tipo</label>
                                        <div class="row">
                                            <div class="form-check col-6">
                                                <input class="form-check-input" type="checkbox" id="solteiro" name="solteiro">
                                                <label class="form-check-label" for="solteiro">Solteiro</label>
                                            </div>
                                            <div class="form-check col-6">
                                                <input class="form-check-input" type="checkbox" id="duplo" name="duplo">
                                                <label class="form-check-label" for="duplo">Duplo</label>
                                            </div>
                                            <div class="form-check col-6">
                                                <input class="form-check-input" type="checkbox" id="casal" name="casal">
                                                <label class="form-check-label" for="casal">Casal</label>
                                            </div>
                                            <div class="form-check col-6">
                                                <input class="form-check-input" type="checkbox" id="triplo" name="triplo">
                                                <label class="form-check-label" for="triplo">Triplo</label>
                                            </div>
                                            <div class="form-check col-6">
                                                <input class="form-check-input" type="checkbox" id="triplo_com_casal" name="triplo_com_casal">
                                                <label class="form-check-label" for="triplo_com_casal">Triplo (com casal)</label>
                                            </div>
                                            <div class="form-check col-6">
                                                <input class="form-check-input" type="checkbox" id="personalizado" name="personalizado">
                                                <label class="form-check-label" for="personalizado">Personalizado</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <label class="form-label">Situação</label>
                                        <div class="form-check col-4">
                                            <input class="form-check-input" type="checkbox" id="available" name="available">
                                            <label class="form-check-label text-success" for="available">Disponível</label>
                                        </div>
                                        <div class="form-check col-4">
                                            <input class="form-check-input" type="checkbox" id="occupied" name="occupied">
                                            <label class="form-check-label text-danger" for="occupied">Ocupado</label>
                                        </div>
                                        <div class="form-check col-4">
                                            <input class="form-check-input" type="checkbox" id="maintenance" name="maintenance">
                                            <label class="form-check-label text-secondary" for="maintenance">Manutenção</label>
                                        </div>
                                    </div>
                                </div>
                                <button class="btn btn-success" type="submit">Aplicar</button>
                            </form>
                        </div>
                    </div> #}
                </div>
            </div>
        </div>
        <div class="col-lg-12 d-flex align-items-stretch">
            <div class="card w-100 shadow-lg">
                <div class="card-body p-4">
                    <div class="d-flex align-items-center justify-content-between">
                        <h5 class="card-title fw-semibold mb-4">Reservas</h5>
                        <div>
                            {% if has_filter %}
                                <a class="btn btn-outline-warning mb-4" href="{{ url_for('rooms') }}">Limpar Filtros</a>
                            {% endif %}
                        <a class="btn btn-success mb-4" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="custom-tooltip"
                            data-bs-title="Se o hóspede já estiver cadastrado você pode ir direto pra reserva."
                            href="{{ url_for('new_reservation') }}">Nova Reserva</a>
                        <a class="btn btn-primary mb-4" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="custom-tooltip"
                            data-bs-title="É necessário cadastrar o hóspede antes de fazer a reserva."
                            href="{{ url_for('new_guest') }}">Novo Hóspede</a>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="table text-nowrap mb-0 align-middle">
                            <thead class="text-dark fs-4">
                                <tr>
                                    <th class="border-bottom-0">
                                        <h6 class="fw-semibold mb-0">Nº Reserva</h6>
                                    </th>
                                    <th class="border-bottom-0">
                                        <h6 class="fw-semibold mb-0">Nº Quarto</h6>
                                    </th>
                                    <th class="border-bottom-0">
                                        <h6 class="fw-semibold mb-0">Nome do Hóspede</h6>
                                    </th>
                                    <th class="border-bottom-0">
                                        <h6 class="fw-semibold mb-0">Check-in</h6>
                                    </th>
                                    <th class="border-bottom-0">
                                        <h6 class="fw-semibold mb-0">Check-out</h6>
                                    </th>
                                    <th class="border-bottom-0">
                                        <h6 class="fw-semibold mb-0">Situação</h6>
                                    </th>
                                    <th class="border-bottom-0">
                                        <h6 class="fw-semibold mb-0">Ações</h6>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for reservation, room_number, name in reservations %}
                                    <tr class="align-items-center">
                                        <td class="border-bottom-0">
                                            <p class="fw-semibold mb-0">{{ reservation.id }}</p>
                                        </td>
                                        <td class="border-bottom-0">
                                            <p class="fw-semibold mb-0">{{ room_number }}</p>
                                        </td>
                                        <td class="border-bottom-0">
                                            <p class="fw-semibold mb-0">{{ name }}</p>
                                            {# <span class="fw-normal">Web Designer</span> #}
                                        </td>
                                        <td class="border-bottom-0">
                                            <p class="mb-0 fw-normal">{{ reservation.check_in.strftime("%d/%m/%Y %H:%M") }}</p>
                                        </td>
                                        <td class="border-bottom-0">
                                            <p class="mb-0 fw-normal">{{ reservation.check_out.strftime("%d/%m/%Y %H:%M") }}</p>
                                        </td>
                                        <td class="border-bottom-0">
                                            {% if reservation.status == "booked" %}
                                            <p class="mb-0 fw-normal">Reservado</p>
                                            {% elif reservation.status == "checked_in" %}
                                            <p class="mb-0 fw-normal text-success">Entrada</p>
                                            {% elif reservation.status == "checked_out" %}
                                            <p class="mb-0 fw-normal text-danger">Saída</p>
                                            {% elif reservation.status == "canceled" %}
                                            <p class="mb-0 fw-normal text-warning">Cancelado</p>
                                            {% endif %}
                                        </td>
                                        <td class="border-bottom-0">
                                            <div class="d-flex align-items-center gap-3 fs-6">
                                                {# <a href="{{ url_for('edit_room', room_id=room.id) }}" class="text-primary" data-bs-toggle="tooltip" data-bs-placement="bottom" title="" data-bs-original-title="Editar" aria-label="Editar"><i class="ti ti-pencil"></i></a>
                                                <a href="{{ url_for('delete_room', room_id=room.id) }}" class="text-danger btn-delete-room" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Deletar" data-bs-original-title="Deletar" aria-label="Deletar"><i class="ti ti-trash"></i></a> #}
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="{{ url_for('dashboard', path='libs/bootstrap/dist/js/bootstrap.bundle.min.js') }}"></script>
<script>
    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
    const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
</script>

<!-- <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const deleteLinks = document.querySelectorAll(".btn-delete-room");

        deleteLinks.forEach(link => {
            link.addEventListener("click", function (e) {
                e.preventDefault();

                const url = this.href;

                Swal.fire({
                    title: "Você tem certeza?",
                    text: "Essa ação é irreversível.",
                    icon: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#3085d6",
                    cancelButtonColor: "#d33",
                    confirmButtonText: "Sim, deletar!"
                }).then((result) => {
                    if (result.isConfirmed) {
                        window.location.href = url;
                    }
                });
            });
        });
    });
</script> -->

{% endblock %}